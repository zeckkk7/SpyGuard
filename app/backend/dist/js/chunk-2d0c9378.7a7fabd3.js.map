{"version":3,"sources":["webpack:///./src/views/instance-misp.vue","webpack:///src/views/instance-misp.vue","webpack:///./src/views/instance-misp.vue?4ce4","webpack:///./src/views/instance-misp.vue?7ab0"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_v","class","active","tabs","addmisp","on","$event","switch_tab","instances","directives","name","rawName","value","mispinst","expression","ref","domProps","target","composing","$set","url","key","startsWith","_e","staticStyle","ssl","Array","isArray","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","slice","add_instance","added","error","_s","length","_m","_l","i","id","replace","apikey","connected","lastsync","delete_instance","loading","staticRenderFns","data","jwt","props","methods","axios","instance","headers","setTimeout","catch","timeout","then","get_misp_instances","e","Object","get_jwt","created","component"],"mappings":"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","file":"js/chunk-2d0c9378.7a7fabd3.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"backend-content\",attrs:{\"id\":\"content\"}},[_c('div',{staticClass:\"column col-8 col-xs-12\"},[_c('h3',{staticClass:\"s-title\"},[_vm._v(\"Gérer les instances MISP\")]),_c('ul',{staticClass:\"tab tab-block\"},[_c('li',{staticClass:\"tab-item\"},[_c('a',{class:{ active: _vm.tabs.addmisp },attrs:{\"href\":\"#\"},on:{\"click\":function($event){return _vm.switch_tab('addmisp')}}},[_vm._v(\"Ajouter une instance\")])]),_c('li',{staticClass:\"tab-item\"},[_c('a',{class:{ active: _vm.tabs.instances },attrs:{\"href\":\"#\"},on:{\"click\":function($event){return _vm.switch_tab('instances')}}},[_vm._v(\"Instances déjà existantes\")])])]),(_vm.tabs.addmisp)?_c('div',[_c('div',{staticClass:\"misp-form\"},[_c('label',{staticClass:\"misp-label\"},[_vm._v(\"Nom de l'instance\")]),_c('span'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mispinst.name),expression:\"mispinst.name\"}],ref:\"misp_name\",staticClass:\"form-input\",attrs:{\"type\":\"text\",\"placeholder\":\"CYBERACME MISP\",\"required\":\"\"},domProps:{\"value\":(_vm.mispinst.name)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.mispinst, \"name\", $event.target.value)}}}),_c('label',{staticClass:\"misp-label\"},[_vm._v(\"URL de l'instance\")]),_c('span'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mispinst.url),expression:\"mispinst.url\"}],ref:\"misp_url\",staticClass:\"form-input\",attrs:{\"type\":\"text\",\"placeholder\":\"https://misp.cyberacme.com\",\"required\":\"\"},domProps:{\"value\":(_vm.mispinst.url)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.mispinst, \"url\", $event.target.value)}}}),_c('label',{staticClass:\"misp-label\"},[_vm._v(\"Clé d'authentification\")]),_c('span'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mispinst.key),expression:\"mispinst.key\"}],ref:\"misp_key\",staticClass:\"form-input\",attrs:{\"type\":\"text\",\"placeholder\":\"OqHSMyAuth3ntic4t10nK3y0MyAuth3ntic4t10nK3y3iiH\",\"required\":\"\"},domProps:{\"value\":(_vm.mispinst.key)},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.mispinst, \"key\", $event.target.value)}}}),(_vm.mispinst.url.startsWith('https://'))?_c('label',{staticClass:\"misp-label\"},[_vm._v(\"Verifier le certificat? \")]):_vm._e(),(_vm.mispinst.url.startsWith('https://'))?_c('span'):_vm._e(),(_vm.mispinst.url.startsWith('https://'))?_c('div',{staticStyle:{\"flex\":\"50%\"}},[_c('label',{staticClass:\"form-switch\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mispinst.ssl),expression:\"mispinst.ssl\"}],attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.mispinst.ssl)?_vm._i(_vm.mispinst.ssl,null)>-1:(_vm.mispinst.ssl)},on:{\"change\":function($event){var $$a=_vm.mispinst.ssl,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.mispinst, \"ssl\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.mispinst, \"ssl\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.mispinst, \"ssl\", $$c)}}}}),_c('i',{staticClass:\"form-icon\"})])]):_vm._e()]),_c('button',{staticClass:\"btn-primary btn col-12\",on:{\"click\":function($event){return _vm.add_instance()}}},[_vm._v(\"Ajouter l'instance MISP\")]),(_vm.added)?_c('div',{staticClass:\"form-group\"},[_c('div',{staticClass:\"toast toast-success\"},[_vm._v(\" ✓ instance MISP ajoutée avec succès. Redirection vers l'instance dans 2 secondes. \")])]):_vm._e(),(_vm.error)?_c('div',{staticClass:\"form-group\"},[_c('div',{staticClass:\"toast toast-error\"},[_vm._v(\" ✗ instance MISP pas ajoutée. \"+_vm._s(_vm.error)+\" \")])]):_vm._e()]):_vm._e(),(_vm.tabs.instances)?_c('div',{staticClass:\"form-group\"},[(_vm.instances.length)?_c('div',[_c('table',{staticClass:\"table table-striped table-hover\"},[_vm._m(0),_c('tbody',_vm._l((_vm.instances),function(i){return _c('tr',{key:i.id},[_c('td',[_vm._v(_vm._s(i.name))]),_c('td',[_vm._v(_vm._s(i.url.replace('https://', '') .replace('http://', '')))]),_c('td',[_vm._v(_vm._s(i.apikey.slice(0,5))+\" [...] \"+_vm._s(i.apikey.slice(35,40)))]),_c('td',[(i.connected)?_c('span',{staticClass:\"instance-online tooltip\",attrs:{\"data-tooltip\":i.lastsync}},[_vm._v(\"✓ EN LIGNE\")]):_c('span',{staticClass:\"instance-offline tooltip\",attrs:{\"data-tooltip\":i.lastsync}},[_vm._v(\"⚠ HORS LIGNE\")])]),_c('td',[_c('button',{staticClass:\"btn btn-sm\",on:{\"click\":function($event){return _vm.delete_instance(i)}}},[_vm._v(\"Suprrimer\")])])])}),0)])]):_c('div',[_c('div',{staticClass:\"empty\"},[(_vm.loading)?_c('div',[_vm._m(1),_c('p',{staticClass:\"empty-subtitle\"},[_vm._v(\"Test et chargement de votre instance MISP.\")])]):_c('div',[_c('p',{staticClass:\"empty-title h5\"},[_vm._v(\"Aucune instance MISP trouvée.\")]),_c('p',{staticClass:\"empty-subtitle\"},[_vm._v(\"N'hésitez pas à ajouter une instance MISP.\")])])])])]):_vm._e()])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('thead',[_c('tr',[_c('th',[_vm._v(\"Nom\")]),_c('th',[_vm._v(\"Serveur\")]),_c('th',[_vm._v(\"Authkey\")]),_c('th',[_vm._v(\"Status\")]),_c('th',[_vm._v(\"Action\")])])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('p',{staticClass:\"empty-title h5\"},[_c('span',{staticClass:\"loading loading-lg\"})])\n}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"backend-content\" id=\"content\">\n        <div class=\"column col-8 col-xs-12\">\n            <h3 class=\"s-title\">Gérer les instances MISP</h3>\n            <ul class=\"tab tab-block\">\n                <li class=\"tab-item\">\n                    <a href=\"#\" v-on:click=\"switch_tab('addmisp')\" v-bind:class=\"{ active: tabs.addmisp }\">Ajouter une instance</a>\n                </li>\n                <li class=\"tab-item\">\n                    <a href=\"#\" v-on:click=\"switch_tab('instances')\" v-bind:class=\"{ active: tabs.instances }\">Instances déjà existantes</a>\n                </li>\n            </ul>\n            <div v-if=\"tabs.addmisp\">\n                <div class=\"misp-form\">\n                    <label class=\"misp-label\">Nom de l'instance</label><span></span>\n                    <input class=\"form-input\" type=\"text\" ref=\"misp_name\" placeholder=\"CYBERACME MISP\" v-model=\"mispinst.name\" required>\n                    <label class=\"misp-label\">URL de l'instance</label><span></span>\n                    <input class=\"form-input\" type=\"text\" ref=\"misp_url\" placeholder=\"https://misp.cyberacme.com\" v-model=\"mispinst.url\" required>\n                    <label class=\"misp-label\">Clé d'authentification</label><span></span>\n                    <input class=\"form-input\" type=\"text\" ref=\"misp_key\" placeholder=\"OqHSMyAuth3ntic4t10nK3y0MyAuth3ntic4t10nK3y3iiH\" v-model=\"mispinst.key\" required>\n                    <label class=\"misp-label\" v-if=\"mispinst.url.startsWith('https://')\">Verifier le certificat? </label><span  v-if=\"mispinst.url.startsWith('https://')\"></span>\n                    <div style=\"flex:50%\" v-if=\"mispinst.url.startsWith('https://')\"><label class=\"form-switch\">\n                    <input type=\"checkbox\" v-model=\"mispinst.ssl\">\n                    <i class=\"form-icon\"></i>\n                    </label></div>\n                </div>\n                <button class=\"btn-primary btn col-12\" v-on:click=\"add_instance()\">Ajouter l'instance MISP</button>\n                <div class=\"form-group\" v-if=\"added\">\n                    <div class=\"toast toast-success\">\n                        ✓ instance MISP ajoutée avec succès. Redirection vers l'instance dans 2 secondes. \n                    </div>\n                </div>\n                <div class=\"form-group\" v-if=\"error\">\n                    <div class=\"toast toast-error\">\n                        ✗ instance MISP pas ajoutée. {{error}}\n                    </div>\n                </div>\n            </div>\n            <div class=\"form-group\" v-if=\"tabs.instances\">\n                <div v-if=\"instances.length\">\n                    <table class=\"table table-striped table-hover\">\n                        <thead>\n                            <tr>\n                                <th>Nom</th>\n                                <th>Serveur</th>\n                                <th>Authkey</th>\n                                <th>Status</th>\n                                <th>Action</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr v-for=\"i in instances\" v-bind:key=\"i.id\">\n                                <td>{{ i.name }}</td>\n                                <td>{{ i.url.replace('https://', '') .replace('http://', '') }}</td>\n                                <td>{{ i.apikey.slice(0,5) }} [...] {{ i.apikey.slice(35,40) }}</td>\n                                <td>\n                                    <span v-if=\"i.connected\" class=\"instance-online tooltip\" :data-tooltip=\"i.lastsync\">✓ EN LIGNE</span>\n                                    <span v-else class=\"instance-offline tooltip\" :data-tooltip=\"i.lastsync\">⚠ HORS LIGNE</span>\n                                </td>\n                                <td><button class=\"btn btn-sm\" v-on:click=\"delete_instance(i)\">Suprrimer</button></td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div v-else>\n                    <div class=\"empty\">\n                        <div v-if=\"loading\">\n                            <p class=\"empty-title h5\">\n                                <span class=\"loading loading-lg\"></span>\n                            </p>\n                            <p class=\"empty-subtitle\">Test et chargement de votre instance MISP.</p>\n                        </div>\n                        <div v-else>\n                            <p class=\"empty-title h5\">Aucune instance MISP trouvée.</p>\n                            <p class=\"empty-subtitle\">N'hésitez pas à ajouter une instance MISP.</p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n\nimport axios from 'axios'\n\nexport default {\n    name: 'managemisp',   \n    data() {\n        return { \n            error:false,\n            loading:false,\n            added:false,\n            mispinst:{ name:'', url:'',key:'', ssl:false },\n            instances:[],\n            tabs: { \"addmisp\" : true, \"instances\" : false },\n            jwt:\"\"\n        }\n    },\n    props: { },\n    methods: {\n        add_instance: function()\n        {  \n            this.added = false;\n            this.error = false;\n            if (this.mispinst.name && this.mispinst.url && this.mispinst.key)\n            {\n                axios.post(`/api/misp/add`, { data: { instance: this.mispinst } }, { headers: {'X-Token': this.jwt} }).then(response => {\n                    if(response.data.status){\n                        this.added = true;\n                        setTimeout(function (){ \n                            this.switch_tab('instances')\n                            this.mispinst = { name:'', url:'',key:'', ssl:false } \n                            this.added = false\n                        }.bind(this), 2000);\n                    } else {\n                        this.error = response.data.message;\n                    }\n                })\n                .catch(err => (console.log(err)))\n            }\n        },\n        delete_instance(elem)\n        {\n            axios.get(`/api/misp/delete/${elem.id}`, { timeout: 10000, headers: {'X-Token': this.jwt} })\n            .then(response => {\n                if(response.data.status){\n                    this.instances = this.instances.filter(function(el) { return el != elem; }); \n                }\n            })\n            .catch(err => (console.log(err)))\n        },\n        get_misp_instances()\n        {\n            this.loading = true;\n            this.instances = []\n            axios.get(`/api/misp/get_all`, { timeout: 10000, headers: {'X-Token': this.jwt} })\n            .then(response => {\n                if(response.data.results){\n                    this.instances = response.data.results;\n                    this.instances.forEach(e => { \n                        var lastsync = parseInt((Date.now()/1000 - e.lastsync) / 86400)\n                        e.lastsync = (!lastsync)? \"Synchronized today\" : `Synchronized ${lastsync} day(s) ago`\n                        } )\n                }\n                this.loading = false\n            })\n            .catch(err => (console.log(err)))\n        },\n        switch_tab: function(tab) {\n\n            Object.keys(this.tabs).forEach(key => {\n                if( key == tab ){\n                    this.tabs[key] = true\n                    if (key == \"instances\") this.get_misp_instances();\n                } else {\n                    this.tabs[key] = false\n                }\n            });\n        },\n        get_jwt(){\n            axios.get(`/api/get-token`, { timeout: 10000 })\n                .then(response => {\n                    if(response.data.token){\n                        this.jwt = response.data.token\n                    }\n                })\n            .catch(err => (console.log(err)))\n        }\n    },\n    created: function() {\n        this.get_jwt();\n    }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./instance-misp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./instance-misp.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./instance-misp.vue?vue&type=template&id=280bcb47&\"\nimport script from \"./instance-misp.vue?vue&type=script&lang=js&\"\nexport * from \"./instance-misp.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}