(function(e){function n(n){for(var a,o,r=n[0],s=n[1],u=n[2],l=0,h=[];l<r.length;l++)o=r[l],Object.prototype.hasOwnProperty.call(c,o)&&c[o]&&h.push(c[o][0]),c[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(n);while(h.length)h.shift()();return i.push.apply(i,u||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],a=!0,o=1;o<t.length;o++){var s=t[o];0!==c[s]&&(a=!1)}a&&(i.splice(n--,1),e=r(r.s=t[0]))}return e}var a={},c={app:0},i=[];function o(e){return r.p+"js/"+({}[e]||e)+"."+{"chunk-2d0a3726":"bc91861e","chunk-2d0c0c86":"e95b21ae","chunk-2d0c8321":"412816e3","chunk-2d0c9378":"7a7fabd3","chunk-2d0cc2b4":"4c5c7759","chunk-2d0cfa15":"46fba702","chunk-2d0e4bf5":"4d1fe4c4","chunk-2d20faf8":"a13358ff","chunk-2d215cd3":"a4f45034","chunk-2d2245cf":"e12816f6","chunk-2d22d432":"9116d142","chunk-3c0d118e":"472ef863"}[e]+".js"}function r(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.e=function(e){var n=[],t=c[e];if(0!==t)if(t)n.push(t[2]);else{var a=new Promise((function(n,a){t=c[e]=[n,a]}));n.push(t[2]=a);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=o(e);var u=new Error;i=function(n){s.onerror=s.onload=null,clearTimeout(l);var t=c[e];if(0!==t){if(t){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",u.name="ChunkLoadError",u.type=a,u.request=i,t[1](u)}c[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:s})}),12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(n)},r.m=e,r.c=a,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)r.d(t,a,function(n){return e[n]}.bind(null,a));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/",r.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var d=u;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"56d7":function(e,n,t){"use strict";t.r(n);var a=t("2b0e"),c=(t("14d9"),function(){var e=this,n=e._self._c;return n("div",{staticClass:"backend-container off-canvas off-canvas-sidebar-show"},[e._m(0),n("div",{staticClass:"backend-sidebar off-canvas-sidebar",attrs:{id:"sidebar"}},[n("div",{staticClass:"backend-brand"},[n("h2",{staticClass:"title",on:{click:function(n){return e.goto_frontend()}}},[e._v(e._s(e.title))]),e.current_version?n("span",{staticClass:"version"},[e._v(e._s(e.current_version))]):e._e()]),n("div",{staticClass:"backend-nav"},[n("div",{staticClass:"accordion-container"},[n("div",{staticClass:"accordion"},[n("input",{attrs:{id:"accordion-configuration",type:"checkbox",name:"backend-accordion-checkbox",hidden:""}}),n("label",{staticClass:"accordion-header c-hand",attrs:{for:"accordion-configuration"}},[e._v("Gérer l'appareil")]),n("div",{staticClass:"accordion-body"},[n("ul",{staticClass:"menu menu-nav"},[n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/device/configuration")}}},[e._v("Config appareil")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/engine/configuration")}}},[e._v("Outil d'analyse")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/device/network")}}},[e._v("Config réseau")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/device/db")}}},[e._v("Gérer la database")])])])])]),n("div",{staticClass:"accordion"},[n("input",{attrs:{id:"accordion-iocs",type:"checkbox",name:"backend-accordion-checkbox",hidden:""}}),n("label",{staticClass:"accordion-header c-hand",attrs:{for:"accordion-iocs"}},[e._v("Gérer les IOCs")]),n("div",{staticClass:"accordion-body"},[n("ul",{staticClass:"menu menu-nav"},[n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/iocs/manage")}}},[e._v("Gérer les IOCs")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/iocs/search")}}},[e._v("Chercher les IOCs")])])])])]),n("div",{staticClass:"accordion"},[n("input",{attrs:{id:"accordion-whitelist",type:"checkbox",name:"backend-accordion-checkbox",hidden:""}}),n("label",{staticClass:"accordion-header c-hand",attrs:{for:"accordion-whitelist"}},[e._v("Gérer la Whitelist")]),n("div",{staticClass:"accordion-body"},[n("ul",{staticClass:"menu menu-nav"},[n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/whitelist/manage")}}},[e._v("Gérer les éléments")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/whitelist/search")}}},[e._v("Chercher les éléments")])])])])]),n("div",{staticClass:"accordion"},[n("input",{attrs:{id:"accordion-instances",type:"checkbox",name:"backend-accordion-checkbox",hidden:""}}),n("label",{staticClass:"accordion-header c-hand",attrs:{for:"accordion-instances"}},[e._v("Sources extérieures")]),n("div",{staticClass:"accordion-body"},[n("ul",{staticClass:"menu menu-nav"},[n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/instances/watchers")}}},[e._v("Watchers Instances")])]),n("li",{staticClass:"menu-item"},[n("span",{on:{click:function(n){return e.$router.push("/instances/misp")}}},[e._v("MISP Instances")])])])])])])])]),n("a",{staticClass:"off-canvas-overlay",attrs:{href:"#close"}}),n("div",{staticClass:"off-canvas-content"},[e.update_available?n("div",{attrs:{id:"update-banner"},on:{click:function(n){return e.$router.push("/update")}}},[e._v("Une nouvelle version est disponible, cliquez sur la bannière pour l'installer.")]):e._e(),n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view")],1)],1)])}),i=[function(){var e=this,n=e._self._c;return n("div",{staticClass:"backend-navbar"},[n("a",{staticClass:"off-canvas-toggle btn btn-link btn-action",attrs:{href:"#sidebar"}},[n("i",{staticClass:"icon icon-menu"})])])}],o=t("bc3a"),r=t.n(o);document.title="SpyGuard Backend";var s={name:"backend",components:{},data(){return{title:"SPYGUARD",current_version:!1,jwt:"",update_available:!1,letters:["SSS§ṠSSSSS","PPPþ⒫PPPP","YYYÿYYYÿYȲYY","GGḠGGGǤG¬G","UÚUUÜUɄUUU","AAAAÄA¬AAA","RЯRɌRRRɌʭR","DD¬DDDDƋDD"]}},methods:{generate_random:function(e=0,n=1e3){let t=n-e,a=Math.random();return a=Math.floor(a*t),a+=e,a},goto_frontend:function(){window.location.href=`http://${location.hostname}:8000`},async get_jwt(){await r.a.get("/api/get-token",{timeout:1e4}).then(e=>{e.data.token&&(this.jwt=e.data.token)}).catch(e=>console.log(e))},get_version:function(){r.a.get("/api/update/get-version",{timeout:6e4,headers:{"X-Token":this.jwt}}).then(e=>{e.data.status&&(this.current_version=e.data.current_version)}).catch(e=>{console.log(e)})},check_update:function(){r.a.get("/api/update/check",{timeout:6e4,headers:{"X-Token":this.jwt}}).then(e=>{"A new version is available"==e.data.message&&(this.update_available=!0)}).catch(e=>{console.log(e)})}},created:function(){this.get_jwt().then(()=>{this.get_version(),this.check_update()}),setInterval(function(){let e="";this.letters.forEach(n=>{e+=n.charAt(this.generate_random(0,9))}),this.title=e,setTimeout(function(){this.title="SPYGUARD"}.bind(this),this.generate_random(30,100))}.bind(this),this.generate_random(500,1e4))}},u=s,l=(t("c3fa"),t("2877")),d=Object(l["a"])(u,c,i,!1,null,null,null),h=d.exports,p=t("8c4f");a["a"].use(p["a"]);const f=[{path:"/",name:"default",component:()=>t.e("chunk-2d0cfa15").then(t.bind(null,"6511")),props:!0},{path:"/device/configuration",name:"device-configuration",component:()=>t.e("chunk-2d0c8321").then(t.bind(null,"549e")),props:!0},{path:"/engine/configuration",name:"engine-configuration",component:()=>t.e("chunk-2d22d432").then(t.bind(null,"f76a")),props:!0},{path:"/device/network",name:"device-network",component:()=>t.e("chunk-3c0d118e").then(t.bind(null,"7e11")),props:!0},{path:"/device/db",name:"db-manage",component:()=>t.e("chunk-2d0e4bf5").then(t.bind(null,"9217")),props:!0},{path:"/iocs/manage",name:"iocs-manage",component:()=>t.e("chunk-2d0c0c86").then(t.bind(null,"42f8")),props:!0},{path:"/instances/misp",name:"instance-misp",component:()=>t.e("chunk-2d0c9378").then(t.bind(null,"57cc")),props:!0},{path:"/instances/watchers",name:"instance-watchers",component:()=>t.e("chunk-2d20faf8").then(t.bind(null,"b54c")),props:!0},{path:"/iocs/search",name:"iocs-search",component:()=>t.e("chunk-2d0cc2b4").then(t.bind(null,"4d7e")),props:!0},{path:"/whitelist/manage",name:"whitelist-manage",component:()=>t.e("chunk-2d215cd3").then(t.bind(null,"c06f")),props:!0},{path:"/whitelist/search",name:"whitelist-search",component:()=>t.e("chunk-2d2245cf").then(t.bind(null,"e08f")),props:!0},{path:"/update",name:"update",component:()=>t.e("chunk-2d0a3726").then(t.bind(null,"01e4")),props:!0}],m=new p["a"]({mode:"history",base:"/",routes:f});var v=m;a["a"].config.productionTip=!0,a["a"].config.devtools=!0,new a["a"]({router:v,render:e=>e(h)}).$mount("#app")},"93c3":function(e,n,t){},c3fa:function(e,n,t){"use strict";t("93c3")}});
//# sourceMappingURL=app.e9166a7f.js.map